<style>
    .video {
        width: 100%;
        height: 100vh;
        overflow-y: auto;
        overflow-x: hidden;
        scrollbar-width: none;
        -ms-overflow-style: none;
        margin: 20px 10px;
        display: none;
    }

    .video::-webkit-scrollbar {
        display: none;
    }

    .list-video {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin: 20px 0;
    }

    .video-item {
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 8px;
        overflow: hidden;
    }

    .video-item img {
        width: 170px;
        /* Giảm kích thước hình ảnh để phù hợp với thẻ cha */
        height: 150px;
        /* Tự động điều chỉnh chiều cao */
    }

    .security {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: rgb(0, 0, 0);
        padding: 10px;
        border-radius: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, .1), 0 8px 16px rgba(0, 0, 0, .1);
    }

    .screen {
        width: 100%;
        height: 50px;
        margin-bottom: 10px;
        text-align: right;
        padding: 10px;
        font-size: 24px;
        background-color: #646262;
        border-radius: 10px;
        color: orange;
    }

    .number{
        display: grid;
        grid-template-columns: repeat(4, 1fr);
    }

    .number button {
        width: 60px;
        height: 60px;
        margin: 5px;
        border: 0;
        border-radius: 5px;
        background-color: transparent;
        font-size: 40px;
        color: rgb(45, 3, 211);
        outline: none;
    }

    .number button:active{
        color: aqua;
    }
</style>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<div class="security">
    <h5 class="text-center text-warning mb-4">Mật Khẩu Ứng Dụng</h5>
    <div id="screen" class="screen"></div>
    <div class="number">
        <button onclick="enterNumber(1)"><i class="bi bi-1-circle"></i></button>
        <button onclick="enterNumber(2)"><i class="bi bi-2-circle"></i></button>
        <button onclick="enterNumber(3)"><i class="bi bi-3-circle"></i></button>
        <button onclick="enterNumber(4)"><i class="bi bi-4-circle"></i></button>
        <button onclick="enterNumber(5)"><i class="bi bi-5-circle"></i></button>
        <button onclick="enterNumber(6)"><i class="bi bi-6-circle"></i></button>
        <button onclick="enterNumber(7)"><i class="bi bi-7-circle"></i></button>
        <button onclick="enterNumber(8)"><i class="bi bi-8-circle"></i></button>
        <button onclick="enterNumber(9)"><i class="bi bi-9-circle"></i></button>
        <button onclick="clearScreen()"><i class="bi bi-x-circle text-danger"></i></button>
        <button onclick="enterNumber(0)"><i class="bi bi-0-circle"></i></button>
        <button onclick="checkPassword()"><i class="bi bi-check-circle text-success"></i></button>
    </div>
</div>


<div class="video">
    <div class="list-video">
        <!-- Các video-item sẽ được thêm ở đây -->
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<!-- Thêm thư viện SheetJS -->

<script>
    var excelUrl = '../public/test.xlsx';

    fetch(excelUrl)
        .then(response => response.arrayBuffer())
        .then(data => {
            // Đọc file Excel sử dụng SheetJS
            var workbook = XLSX.read(data, { type: 'array' });
            var firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            var excelData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

            // Mảng để lưu trữ dữ liệu các cột
            var name = [];   // Mảng cho cột tên video
            var video = [];  // Mảng cho cột video URL
            var image = [];  // Mảng cho cột hình ảnh

            // Duyệt qua từng hàng của sheet và tách từng cột vào mảng
            excelData.forEach(function (row, index) {
                if (index !== 0) { // Bỏ qua hàng đầu tiên nếu đó là header
                    name.push(row[0]);  // Tên video
                    video.push(row[1]); // Link video
                    image.push(row[2]); // Link ảnh
                }
            });

            // Lấy thẻ danh sách video
            var listVideo = document.querySelector('.list-video');

            // Tạo các phần tử video-item cho mỗi video
            image.forEach((imgSrc, index) => {
                var videoItem = document.createElement('div');
                videoItem.classList.add('video-item');

                // Tạo thẻ a cho video
                var linkElement = document.createElement('a');
                linkElement.href = video[index]; // Đặt href là link video
                linkElement.target = "_blank"; // Mở liên kết trong tab mới

                // Tạo thẻ img cho hình ảnh video
                var imgElement = document.createElement('img');
                imgElement.src = '../public/image_video/' + imgSrc; // Đặt nguồn hình ảnh
                imgElement.alt = `Video: ${name[index]}`;  // Đặt alt cho hình ảnh

                // Gắn thẻ img vào thẻ a
                linkElement.appendChild(imgElement);

                // Gắn thẻ a vào video-item
                videoItem.appendChild(linkElement);

                // Thêm video-item vào danh sách
                listVideo.appendChild(videoItem);
            });
        })
        .catch(error => console.error('Lỗi khi tải file Excel:', error));

    var enteredPassword = "";
    var correctPassword = "09646478540964896483";
    function enterNumber(number) {
        enteredPassword += number;
        updateScreen();
    }

    function updateScreen() {
        document.getElementById("screen").innerText = enteredPassword;
    }

    function clearScreen() {
        enteredPassword = enteredPassword.slice(0, -1); // Xóa 1 ký tự sau cùng
        updateScreen();
    }

    function checkPassword() {
        if (enteredPassword === correctPassword) {
            $('.security').fadeOut();
            $('.video').fadeIn();
        } else {
            $('.security').addClass('animate__animated animate__shakeX');
            $('.screen').html('');
            enteredPassword="";
            setTimeout(function() {
                $('.security').removeClass('animate__animated animate__shakeX');
            }, 2000);
        }
    }

</script>